---
title: "ActiveRecordã‚’ç”¨ã„ã¦å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ã‚’å–å¾—ã™ã‚‹"
emoji: "ğŸ˜Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [rails]
published: true
---

å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ã‚’å–å¾—ã—ãŸã‹ã£ãŸã®ã§ã€ä¸‹è¨˜ã®ã‚ˆã†ã« ActiveRecord ã‚’ä½¿ã£ã¦å–å¾—ã—ãŸ

```rb
tables = ActiveRecord::Base.connection.tables

models = tables.map(&:classify).map(&:safe_constantize).compact

models.each do |model|
  puts "#{model}: #{model.count}"
end
```

`ActiveRecord::Base.connection.tables`ã§ãƒ†ãƒ¼ãƒ–ãƒ«åãŒå…¥ã£ãŸé…åˆ—ã‚’å–å¾—ã—ã¾ã™
`tables.map(&:classify)`ã§ãƒ†ãƒ¼ãƒ–ãƒ«åã‹ã‚‰ãƒ¢ãƒ‡ãƒ«åã¸å¤‰æ›
`map(&:safe_constantize)`ã§æ–‡å­—åˆ—ã‚’ã‚¯ãƒ©ã‚¹åŒ–ã€ã‚¯ãƒ©ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ nil ã‚’è¿”ã™ã®ã§`compact`ã§ nil ã‚’é™¤å¤–ã—ã¾ã™

## å‚è€ƒ

- https://acoder.hatenablog.com/entry/2015/04/16/021351
- https://railsdoc.com/page/classify
- https://apidock.com/rails/v5.2.3/ActiveSupport/Inflector/safe_constantize
