---
title: "Chakra UIã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’å–ã‚‹æ–¹æ³•"
emoji: "ğŸƒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [chakraui, jest]
published: true
---

## Chakra UI ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒã†ã¾ãå–ã‚Œãªã„

Jest ã§ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã„ãŸã‚‰ã€Chakra UI ã®ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã†ã¾ãå–ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

### example

```tsx
import renderer from "react-test-renderer";
import * as React from "react";

import {
  Button,
  Modal,
  ModalBody,
  ModalCloseButton,
  ModalContent,
  ModalFooter,
  ModalHeader,
  ModalOverlay,
  useDisclosure,
} from "@chakra-ui/react";

const ChakraUiModal: React.VFC = () => {
  const { onClose } = useDisclosure();

  return (
    <>
      <Modal isOpen={true} onClose={onClose}>
        <ModalOverlay />
        <ModalContent>
          <ModalHeader>Modal Title</ModalHeader>
          <ModalCloseButton />
          <ModalBody>Content</ModalBody>

          <ModalFooter>
            <Button onClick={onClose}>Close</Button>
            <Button>Secondary Action</Button>
          </ModalFooter>
        </ModalContent>
      </Modal>
    </>
  );
};

it("renders correctly", () => {
  const tree = renderer.create(<ChakraUiModal />).toJSON();
  expect(tree).toMatchSnapshot();
});
```

ä¾‹ãˆã°ä¸Šè¨˜ã®é€šã‚Šã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’å–ã‚ã†ã¨ã™ã‚‹ã¨çµæœã¯ä¸‹è¨˜ã®å½¢ã«ãªã‚Šã¾ã™ã€‚

```
// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`renders correctly 1`] = `<span />`;
```

ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒå–ã‚Œãš span ã‚¿ã‚°ã«ãªã£ã¦ã„ã‚‹ã®ãŒã‚ã‹ã‚Šã¾ã™ã€‚

## è§£æ±ºæ–¹æ³•

è‰²ã€…èª¿ã¹ãŸçµæœã€ä¸‹è¨˜ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚

https://stackoverflow.com/questions/48373732/jest-snapshots-not-working-with-some-semantic-ui-react-components/49290892#49290892

ã“ã¡ã‚‰ã¯`Semantic-UI-React`ã«é–¢ã™ã‚‹è¨˜äº‹ã§ã™ãŒã€
ä½•ã‚’ã—ã¦ã„ã‚‹ã‹ã¨ã„ã†ã¨`jest.mock`ã‚’ä½¿ã£ã¦`Modal`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ©ãƒƒãƒ—ã—ã¦ã„ã‚‹`Portal`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã€`Modal`ä»¥ä¸‹ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ãƒ¢ãƒƒã‚¯ã—ã¦ã„ã¾ã™ã€‚

`Chakra UI`ã®`Modal`ã®å®Ÿè£…ã‚’è¦‹ã¦ã„ã‚‹ã¨åŒæ§˜ã«`Portal`ã§ãƒ©ãƒƒãƒ—ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
https://github.com/chakra-ui/chakra-ui/blob/main/packages/modal/src/modal.tsx#L179

`Portal`ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã«èª¬æ˜ãŒè¼‰ã£ã¦ã„ã¾ã™ãŒã€ä»»æ„ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„è¦ç´ ã‚’`document.body`ã®æœ«å°¾ã«ç§»å‹•ã—ã€ãã“ã« React ãƒ„ãƒªãƒ¼ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚‚ã®ã§ã™ã€‚
popovers ã‚„ dropdownsã€modals ã®ãŸã‚ã®ã‚‚ã®ã¨æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚
https://chakra-ui.com/docs/components/portal

`Portal`ã®å®Ÿè£…ã‚‚ä¸€å¿œè¦‹ã¦ã¿ã‚‹ã¨ã€`Portal`ãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¦ span ã‚¿ã‚°ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒè¿”ã£ã¦ããŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
https://github.com/chakra-ui/chakra-ui/blob/main/packages/portal/src/portal.tsx#L85

ãªã®ã§ã€`Chakra UI`ã§ã‚‚`Portal`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã€`Modal`ä»¥ä¸‹ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ãƒ¢ãƒƒã‚¯ã™ã‚‹æ–¹æ³•ãŒä½¿ã†ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

ä¸‹è¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã¨ã€

```tsx
import { ReactNode } from "react";

type Props = {
  children: ReactNode;
};

jest.mock("@chakra-ui/portal", () => ({
  Portal: jest.fn(({ children }: Props) => children),
}));
```

çµæœãŒä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã€ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒç„¡äº‹å–ã‚Œã¾ã—ãŸã€‚

```
// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`renders correctly 1`] = `
Array [
  <div
    className="chakra-modal__overlay css-13d1tkw"
    style={
      Object {
        "opacity": 0,
      }
    }
  />,
  <div
    data-focus-guard={true}
    style={
      Object {
        "height": "0px",
        "left": "1px",
        "overflow": "hidden",
        "padding": 0,
        "position": "fixed",
        "top": "1px",
        "width": "1px",
      }
    }
    tabIndex={0}
  />,
  <div
    data-focus-guard={true}
    style={
      Object {
        "height": "0px",
        "left": "1px",
        "overflow": "hidden",
        "padding": 0,
        "position": "fixed",
        "top": "1px",
        "width": "1px",
      }
    }
    tabIndex={1}
  />,
  <div
    data-focus-lock-disabled={false}
    onBlur={[Function]}
    onFocus={[Function]}
  >
    <div
      className="chakra-modal__content-container css-k2m3mz"
      onClick={[Function]}
      onKeyDown={[Function]}
      onMouseDown={[Function]}
      onScrollCapture={[Function]}
      onTouchMoveCapture={[Function]}
      onWheelCapture={[Function]}
      tabIndex={-1}
    >
      <section
        aria-describedby="chakra-modal--body-1715723249-2"
        aria-labelledby="chakra-modal--header-1715723249-2"
        aria-modal={true}
        className="chakra-modal__content css-6yiygt"
        id="chakra-modal-1715723249-2"
        onClick={[Function]}
        role="dialog"
        style={
          Object {
            "opacity": 0,
            "transform": "scale(0.95) translateZ(0)",
          }
        }
        tabIndex={-1}
      >
        <header
          className="chakra-modal__header css-72fd9l"
          id="chakra-modal--header-1715723249-2"
        >
          Modal Title
        </header>
        <button
          aria-label="Close"
          className="chakra-modal__close-btn css-6sdaxy"
          onClick={[Function]}
          type="button"
        >
          <svg
            aria-hidden={true}
            className="chakra-icon css-onkibi"
            focusable="false"
            viewBox="0 0 24 24"
          >
            <path
              d="M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"
              fill="currentColor"
            />
          </svg>
        </button>
        <div
          className="chakra-modal__body css-0"
          id="chakra-modal--body-1715723249-2"
        >
          Content
        </div>
        <footer
          className="chakra-modal__footer css-192qrng"
        >
          <button
            className="chakra-button css-5c2176"
            onClick={[Function]}
            type="button"
          >
            Close
          </button>
          <button
            className="chakra-button css-5c2176"
            type="button"
          >
            Secondary Action
          </button>
        </footer>
      </section>
    </div>
  </div>,
  <div
    data-focus-guard={true}
    style={
      Object {
        "height": "0px",
        "left": "1px",
        "overflow": "hidden",
        "padding": 0,
        "position": "fixed",
        "top": "1px",
        "width": "1px",
      }
    }
    tabIndex={0}
  />,
]
`;
```
